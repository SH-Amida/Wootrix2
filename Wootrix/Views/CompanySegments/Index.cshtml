@model IEnumerable<WootrixV2.Models.CompanySegment>

@using Microsoft.AspNetCore.Identity
@using Microsoft.AspNetCore.Http;
@using System.Security.Claims
@using WootrixV2.Data;

@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager

@{
    ViewData["Title"] =  "Index";
    Layout = "~/Views/Shared/_LayoutCompany.cshtml";
    var _companyName = UserManager.GetUserAsync(User).GetAwaiter().GetResult().companyName;
}


<div class="articleBackButtonContainer">
    <a asp-controller="Company" asp-action="Home" asp-route-id="@_companyName">
        <button class="articleBackButton button">
            <span class="glyphicon glyphicon-menu-left"></span>
            Admin Home
        </button>
    </a>

</div>

<div class="bodyBox">
    <h2>Magazines</h2>

    <p>
        <a asp-action="Create">Create New</a>
    </p>
    <table class="table">
        <thead>
            <tr>
                <th class="magazine-header-text">
                    <h2>Magazines</h2>
                </th>
            </tr>
        </thead>
        <tbody>
            <tr>

                @foreach (var item in Model)
                {                   
                    <td class="magazine" @*style="border:4px solid @item.ThemeColor;  background:@item.StandardColor;" *@>

                        <div class="magazine-order">
                            <label class="control-label">Order</label>
                            <select class="OrderSelector">

                                @foreach (var it in Model)
                                {

                                    if (item.Order == it.Order)
                                    {
                                        <option value="@it.Order.Value" selected="selected">@it.Order.Value</option>
                                    }
                                    else
                                    {
                                        <option value="@item.ID">@it.Order.Value</option>
                                    }
                                }

                            </select>

                        </div>
                        <a asp-action="Details" asp-route-id="@item.ID">
                            <div class="magazine-pic">
                                @{
                                    var fn = _companyName + "_" + item.CoverImage;
                                }
                                <img src="~/images/Uploads/@fn" />
                            </div>
                        </a>
                        <div class="magazine-text">
                            <div class="magazine-text-title">
                                @Html.DisplayFor(modelItem => item.Title)
                            </div>
                            <div class="magazine-text-dates">
                                @Html.DisplayFor(modelItem => item.PublishDate) -
                                @Html.DisplayFor(modelItem => item.FinishDate)
                            </div>


                            @{
                                var draftOrNot = "Publish";
                                var color = item.ThemeColor;
                                if (item.Draft == false)
                                {

                                    draftOrNot = "Published";


                                }
                                else
                                {
                                    draftOrNot = "Draft";
                                    color = item.StandardColor;


                                }
                            }
                            <div class="magazine-text-draft btn btn-default" style="background:@color">
                                @draftOrNot
                            </div>
                            <a asp-action="Edit" class="btn btn-default" asp-route-id="@item.ID">
                                <div class="magazine-text-edit" style="background:@Html.DisplayFor(modelItem => item.StandardColor)">
                                    Edit

                                </div>
                            </a>
                            <a asp-action="Delete" class="btn btn-default" asp-route-id="@item.ID">
                                <div class="magazine-text-delete" style="background:@Html.DisplayFor(modelItem => item.StandardColor)">
                                    Delete

                                </div>
                            </a>
                        </div>

                    </td>
                }
            </tr>
        </tbody>
    </table>
</div>

